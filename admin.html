<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de AdministraciÃ³n - ESTRELLA G&C</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="index.html">ESTRELLA G&C - Admin</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarAdmin">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarAdmin">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html"><i class="fas fa-store me-1"></i> Tienda</a>
          </li>
          <li class="nav-item">
            <button class="nav-link btn btn-link text-white" id="btnCerrarSesion">
              <i class="fas fa-sign-out-alt me-1"></i> Cerrar sesiÃ³n
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <h2>Panel de AdministraciÃ³n</h2>
    
    <ul class="nav nav-tabs" id="adminTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pedidos-tab" data-bs-toggle="tab" data-bs-target="#pedidos" type="button" role="tab">Pedidos</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="productos-tab" data-bs-toggle="tab" data-bs-target="#productos" type="button" role="tab">Productos</button>
      </li>
    </ul>
    
    <div class="tab-content mt-3" id="adminTabsContent">
      <div class="tab-pane fade show active" id="pedidos" role="tabpanel">
        <h3>Pedidos Recientes</h3>
        <div class="mb-3">
          <select id="filtroEstado" class="form-select w-auto d-inline-block">
            <option value="todos">Todos los estados</option>
            <option value="pendiente">Pendientes</option>
            <option value="confirmado">Confirmados</option>
            <option value="enviado">Enviados</option>
            <option value="entregado">Entregados</option>
          </select>
        </div>
        <div id="listaPedidos">
          <div class="alert alert-info">Cargando pedidos...</div>
        </div>
      </div>
      
      <!-- En la secciÃ³n de productos del admin.html, agrega esto despuÃ©s del botÃ³n "Agregar Producto" -->
<div class="tab-pane fade" id="productos" role="tabpanel">
    <h3>GestiÃ³n de Productos</h3>
    
    <!-- Controles de filtro -->
    <div class="row mb-3">
        <div class="col-md-6">
            <div class="d-flex align-items-center gap-3">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalProducto">
                    <i class="fas fa-plus me-1"></i> Agregar Producto
                </button>
                
                <select id="filtroCategoria" class="form-select w-auto">
                    <option value="todas">Todas las categorÃ­as</option>
                    <!-- Las categorÃ­as se cargarÃ¡n dinÃ¡micamente -->
                </select>
            </div>
        </div>
        <div class="col-md-6 text-end">
            <small class="text-muted" id="infoFiltroProductos">
                Cargando informaciÃ³n...
            </small>
        </div>
    </div>
    
    <div class="row" id="listaProductos">
        <div class="col-12">
            <div class="alert alert-info">Cargando productos...</div>
        </div>
    </div>
</div>
    </div>
  </div>

  <!-- Modal para agregar/editar productos -->
  <div class="modal fade" id="modalProducto" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalProductoTitulo">Agregar Producto</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="formProducto">
            <input type="hidden" id="productoId">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Nombre *</label>
                <input type="text" class="form-control" id="productoNombre" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Precio *</label>
                <input type="number" step="0.01" class="form-control" id="productoPrecio" required>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">CategorÃ­a *</label>
                <select class="form-control" id="productoCategoria" required>
                  <option value="">Selecciona una categorÃ­a</option>
                  <option value="abarrotes">ğŸ›’ Abarrotes</option>
                  <option value="lacteos">ğŸ¥› LÃ¡cteos</option>
                  <option value="bebidas">ğŸ¥¤ Bebidas</option>
                  <option value="condimentos">ğŸ§‚ Condimentos</option>
                  <option value="botanas">ğŸ¿ Botanas</option>
                  <option value="utensilios">ğŸ½ï¸ Utensilios</option>
                  <option value="bebidas_alcoholicas">ğŸº Bebidas AlcohÃ³licas</option>
                  <option value="huevos">ğŸ¥š Huevos</option>
                  <option value="cuidado_personal">ğŸ§´ Cuidado Personal</option>
                  <option value="cuidado_bebe">ğŸ‘¶ Cuidado del BebÃ©</option>
                  <option value="limpieza">ğŸ§¼ Limpieza</option>
                  <option value="frutas_verduras">ğŸ Frutas & Verduras</option>
                  <option value="panaderia">ğŸ¥– PanaderÃ­a</option>
                  <option value="carnes">ğŸ¥© Carnes</option>
                  <option value="congelados">ğŸ§Š Congelados</option>
                  <option value="enlatados">ğŸ¥« Enlatados</option>
                  <option value="cereales">ğŸŒ¾ Cereales</option>
                  <option value="dulces">ğŸ¬ Dulces</option>
                  <option value="mascotas">ğŸ¾ Mascotas</option>
                  <option value="electrodomesticos">ğŸ”Œ ElectrodomÃ©sticos</option>
                  <option value="ropa">ğŸ‘• Ropa</option>
                  <option value="juguetes">ğŸ§¸ Juguetes</option>
                  <option value="deportes">âš½ Deportes</option>
                  <option value="libros">ğŸ“š Libros</option>
                  <option value="jardin">ğŸŒ» JardÃ­n</option>
                  <option value="ferreteria">ğŸ› ï¸ FerreterÃ­a</option>
                  <option value="farmacia">ğŸ’Š Farmacia</option>
                  <option value="automotriz">ğŸš— Automotriz</option>
                  <!-- ... otras categorÃ­as ... -->
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Stock *</label>
                <input type="number" class="form-control" id="productoStock" required>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label">Imagen *</label>
              <input type="text" class="form-control" id="productoImagen" required>
              <div class="form-text">Nombre del archivo de imagen (debe estar en la carpeta img/)</div>
            </div>
            <div class="mb-3">
              <label class="form-label">DescripciÃ³n</label>
              <textarea class="form-control" id="productoDescripcion" rows="3"></textarea>
            </div>
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="productoDestacado">
              <label class="form-check-label" for="productoDestacado">
                Producto destacado
              </label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="guardarProducto">Guardar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Nuestros scripts -->
  <script src="js/firebase.js"></script>
  <script src="js/admin.js"></script>

  <!-- Script de autenticaciÃ³n -->
  <script>
    // Verificar autenticaciÃ³n
    firebase.auth().onAuthStateChanged((user) => {
      if (!user) {
        window.location.href = 'login.html';
      }
    });

    // Cerrar sesiÃ³n
    document.getElementById('btnCerrarSesion').addEventListener('click', () => {
      firebase.auth().signOut().then(() => {
        window.location.href = 'login.html';
      });
    });

    // Manejo de errores global
    window.addEventListener('error', function(e) {
      console.error('Error en admin:', e.error);
    });
  </script>
</body>
</html>